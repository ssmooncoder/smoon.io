{"componentChunkName":"component---src-templates-blog-post-js","path":"/sns-sqs-node/","result":{"data":{"site":{"siteMetadata":{"title":"Samuel Moon"}},"markdownRemark":{"id":"6bcdf65a-e6e6-5f0b-b63e-071b309f2061","excerpt":"Version 3 of the JavaScript SDK now splits up the package into smaller modules. This way, you only download what you need and reduce your file size. Packages…","html":"<p>Version 3 of the JavaScript SDK now splits up the package into smaller modules. This way, you only download what you need and reduce your file size. Packages are downloaded in the form of:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> @aws-sdk/client-«package-name»</code></pre></div>\n<p>If you can’t remember the name of the package, simply search to return a list of names:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> @aws-sdk/client-\nNAME                      <span class=\"token operator\">|</span> DESCRIPTION          <span class=\"token operator\">|</span>\n@aws-sdk/client-s3        <span class=\"token operator\">|</span> AWS SDK for…         <span class=\"token operator\">|</span>\n@aws-sdk/client-sts       <span class=\"token operator\">|</span> AWS SDK for…         <span class=\"token operator\">|</span>\n@aws-sdk/client-lex-runti <span class=\"token operator\">|</span> AWS SDK for…         <span class=\"token operator\">|</span>\nme-service                <span class=\"token operator\">|</span>                      <span class=\"token operator\">|</span>\n@aws-sdk/client-transcrib <span class=\"token operator\">|</span> AWS SDK for…         <span class=\"token operator\">|</span>\ne-streaming               <span class=\"token operator\">|</span>                      <span class=\"token operator\">|</span>\n@aws-sdk/client-s3-contro <span class=\"token operator\">|</span> AWS SDK for…         <span class=\"token operator\">|</span>\nl                         <span class=\"token operator\">|</span>                      <span class=\"token operator\">|</span>\n@aws-sdk/client-mediastor <span class=\"token operator\">|</span> AWS SDK for…         <span class=\"token operator\">|</span>\ne-data                    <span class=\"token operator\">|</span>                      <span class=\"token operator\">|</span>\n@aws-sdk/client-cognito-i <span class=\"token operator\">|</span> AWS SDK for…         <span class=\"token operator\">|</span>\ndentity                   <span class=\"token operator\">|</span>                      <span class=\"token operator\">|</span></code></pre></div>\n<p>You can use ES6-style imports for modules. Note: you can’t mix and match both style of imports.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span> SQSClient <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@aws-sdk/client-sqs)\"</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// old way</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> SQSClient <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@aws-sdk/client-sqs\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// new way</span>\n\n<span class=\"token comment\">// Be sure to add this to \"/package.json\" to use ES6 imports</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"module\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h1>SQS</h1>\n<p>You’ll need a client object to send your commands.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * Save file to somewhere like \"/libs/sql-client.js\"\n * to reuse an existing client object.\n */</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> SQSClient <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@aws-sdk/client-sqs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">REGION</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"us-west-1\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQSClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> region<span class=\"token operator\">:</span> <span class=\"token constant\">REGION</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> client <span class=\"token punctuation\">}</span></code></pre></div>\n<h2>ListQueuesCommand</h2>\n<p><code class=\"language-text\">ListQueuesCommand</code> requires you to supply an empty object as its default argument.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ListQueuesCommand <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@aws-sdk/client-sqs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> client <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./lib/sqs-client.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">listQueues</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ListQueuesCommand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span>stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">listQueues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Run the file at the terminal with <code class=\"language-text\">node «file-name».js</code> and you’ll receive the following response:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ node list-command.js\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'<span class=\"token variable\">$metadata</span>'</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span>\n    httpStatusCode: <span class=\"token number\">200</span>,\n    requestId: <span class=\"token string\">'59314882-ba58-5429-a820-a8aec8f020f2'</span>,\n    extendedRequestId: undefined,\n    cfId: undefined,\n    attempts: <span class=\"token number\">1</span>,\n    totalRetryDelay: <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span>,\n  NextToken: undefined,\n  QueueUrls: <span class=\"token punctuation\">[</span> <span class=\"token string\">'https://sqs.us-west-1.amazonaws.com/248874545298/«QueueName»'</span> <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You can grab the <code class=\"language-text\">QueueUrl</code> here, or use <code class=\"language-text\">GetQueueUrlCommand</code> if you know the name of your queue.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> GetQueueUrlCommand <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@aws-sdk/client-sqs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> client <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span>  <span class=\"token string\">\"./lib/sqs-client.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> QueueName<span class=\"token operator\">:</span> <span class=\"token string\">\"QUEUE_NAME\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">queueName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">GetQueueUrlCommand</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">queueName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>SendMessageCommand</h2>\n<p>You’ll need the <code class=\"language-text\">QueueUrl</code> from above to send and receive messages from a queue. <code class=\"language-text\">SendMessageCommand</code> accepts a single object that implements the <a href=\"https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-sqs/interfaces/sendmessagecommandinput.html\"><code class=\"language-text\">SendMessageCommandInput</code></a> interface. If you’re not familiar with TypeScript, it means your object must match the following signature:</p>\n<ul>\n<li><strong><code class=\"language-text\">MessageBody</code></strong> - must be a <code class=\"language-text\">string</code> type. This means you must <code class=\"language-text\">JSON.stringify()</code> any JSON object you want to pass in here. The documentation states that “a message can include only XML, JSON, and unformatted text”, but raw JSON objects seem to fail (could be a bug).</li>\n<li>\n<p><strong><code class=\"language-text\">MessageAttributes</code></strong> - an <em>optional</em> object intended to be used as metadata (i.e. supplementary info about more important stuff in <code class=\"language-text\">MessageBody</code>). Can have up to 10 nested objects called <strong>attributes</strong>.</p>\n<ul>\n<li>Although even the <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-message-metadata.html#sqs-message-attributes\">documentation</a> affirms its use as “structured metadata (such as timestamps, geospatial data, signatures, and identifiers)”, AWS’s <a href=\"https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/sqs-examples-send-receive-messages.html\">official example</a> switches <strong><code class=\"language-text\">MessageBody</code></strong> and <strong><code class=\"language-text\">MessageAttributes</code></strong>.</li>\n</ul>\n</li>\n<li><strong><code class=\"language-text\">QueueUrl</code></strong> - a required parameter of <code class=\"language-text\">string</code> type. This is where the messages are sent.</li>\n</ul>\n<p>The example below uses <code class=\"language-text\">JSON.stringify()</code> to pass a JSON object to <code class=\"language-text\">MessageBody</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> SendMessageCommand <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span>  <span class=\"token string\">\"@aws-sdk/client-sqs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> client <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span>  <span class=\"token string\">\"./lib/sqs-client.js\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> getQueue <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\".lib/sqs-listqueues.js\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// grab queue URL</span>\n\n<span class=\"token comment\">// Example using a credit card transaction.</span>\nbody <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  TransactionId<span class=\"token operator\">:</span> <span class=\"token string\">\"758191\"</span><span class=\"token punctuation\">,</span>\n  CustomerId<span class=\"token operator\">:</span> <span class=\"token string\">\"CID_132\"</span><span class=\"token punctuation\">,</span>\n  CustomerEmail<span class=\"token operator\">:</span> <span class=\"token string\">\"foo@bar.com\"</span><span class=\"token punctuation\">,</span>\n  Amount<span class=\"token operator\">:</span> <span class=\"token number\">50.00</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  MessageBody<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sendMessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    params<span class=\"token punctuation\">.</span>QueueUrl <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span> <span class=\"token comment\">// Add queue URL to params object.</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SendMessageCommand</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> data\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span>stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>ReceiveMessageCommand, DeleteMessageCommand</h2>\n<p>Messages retrieved from the queue should be deleted once read, to prevent other consumers from reading a duplicate message.</p>\n<p><code class=\"language-text\">ReceiveMessageCommand</code> accepts an input parameter that implements <code class=\"language-text\">ReceiveMessageCommandInput</code> interface. The object has the following properties:</p>\n<ul>\n<li>\n<p><strong><code class=\"language-text\">AttributeNames</code></strong> - <em>optional</em>, returns a list of attributes along with each message. Possible values are:</p>\n<ul>\n<li><strong><code class=\"language-text\">All</code></strong> - returns all values.</li>\n<li><strong><code class=\"language-text\">ApproximateFirstReceiveTimestamp</code></strong> - time when message was first received from queue (in milliseconds).</li>\n<li><strong><code class=\"language-text\">ApproximateReceiveCount</code></strong> - how many times message was previously retrieved.</li>\n<li><strong><code class=\"language-text\">SenderId</code></strong> - IAM user or role ID.</li>\n<li><strong><code class=\"language-text\">SentTimestamp</code></strong> - time when message was sent to queue (in milliseconds).</li>\n</ul>\n</li>\n<li><strong><code class=\"language-text\">MaxNumberOfMessages</code></strong> - <em>optional</em>, defaults to 1. Valid values are from 1 to 10.</li>\n<li><strong><code class=\"language-text\">QueueUrl</code></strong> - URI of queue where messages are retrieved from.</li>\n<li><strong><code class=\"language-text\">VisibilityTimeout</code></strong> - <em>optional</em>, how long (in seconds) to hide messages from subsequent requests.</li>\n<li><strong><code class=\"language-text\">WaitTimeSeconds</code></strong> - <em>optional</em>, how long the call waits for a message to be available in the queue (if empty).</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ReceiveMessageCommand<span class=\"token punctuation\">,</span> DeleteMessageCommand <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@aws-sdk/client-sqs\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> client <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./lib/sqs-getclient.js\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> getQueue <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./lib/sqs-listqueues.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> params <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  AttributeNames<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"All\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  MaxNumberOfMessages<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">receiveDelete</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    params<span class=\"token punctuation\">.</span>QueueUrl <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ReceiveMessageCommand</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>Messages<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        \n      <span class=\"token comment\">// object used to delete retrieved message</span>\n      <span class=\"token keyword\">let</span> delParams <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        QueueUrl<span class=\"token operator\">:</span> url<span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// ReceiptHandle is the identifier used</span>\n        <span class=\"token comment\">// to delete a specific message</span>\n        ReceiptHandle<span class=\"token operator\">:</span> data<span class=\"token punctuation\">.</span>Messages<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ReceiptHandle\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      \n      <span class=\"token comment\">// Print retrieved message.</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>Messages<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">?.</span>Body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      \n      <span class=\"token comment\">// Delete retrieved message</span>\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DeleteMessageCommand</span><span class=\"token punctuation\">(</span>delParams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Message deleted:\"</span><span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      \n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"receive error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span>stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">receiveDelete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"Setting up AWS SDK for SNS/SQS in Node.js","date":"May 01, 2020","description":"Setting up AWS SDK for SNS/SQS in Node.js"}},"previous":{"fields":{"slug":"/shell-config/"},"frontmatter":{"title":"Shell (zsh/bash) Configuration"}},"next":null},"pageContext":{"id":"6bcdf65a-e6e6-5f0b-b63e-071b309f2061","previousPostId":"5e796c1d-8078-5d37-bbae-358fc55c59c2","nextPostId":null}},"staticQueryHashes":["230163734","3589320610"]}